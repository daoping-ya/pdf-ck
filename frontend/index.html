<!DOCTYPE html>
<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF在线处理工具</title>
    <link rel="stylesheet" href="css/style.css?v=20251124">
</head>

<body>
    <div class="container">
        <!-- 头部 -->
        <header class="header">
            <div class="logo">
                <svg class="logo-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                    <path
                        d="M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-8.5 7.5c0 .83-.67 1.5-1.5 1.5H9v2H7.5V7H10c.83 0 1.5.67 1.5 1.5v1zm5 2c0 .83-.67 1.5-1.5 1.5h-2.5V7H15c.83 0 1.5.67 1.5 1.5v3zm4-3H19v1h1.5V11H19v2h-1.5V7h3v1.5zM9 9.5h1v-1H9v1zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm10 5.5h1v-3h-1v3z" />
                </svg>
                <span>PDF在线工具箱</span>
            </div>
            <div class="system-status">
                <div class="status-dot"></div>
                <span id="statusText">连接中...</span>
                <button class="icon-btn" id="settingsBtn" title="设置" style="margin-left: 10px;">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <path
                            d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.1a2 2 0 0 1-1-1.72v-.51a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z" />
                        <circle cx="12" cy="12" r="3" />
                    </svg>
                </button>
            </div>
        </header>

        <!-- 主内容区 -->
        <main class="main-content">
            <!-- 上传区域 -->
            <div class="upload-section" id="uploadSection">
                <div class="upload-box" id="uploadBox">
                    <svg class="upload-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                        <polyline points="17 8 12 3 7 8" />
                        <line x1="12" y1="3" x2="12" y2="15" />
                    </svg>
                    <h2>拖拽PDF文件至此</h2>
                    <p>或点击选择文件</p>
                    <input type="file" id="fileInput" accept=".pdf" hidden>
                    <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()">
                        选择PDF文件
                    </button>
                    <p class="upload-hint">最大支持20MB,建议30页以内</p>
                </div>
            </div>

            <!-- 文件信息和工具栏 -->
            <div class="file-panel" id="filePanel" style="display: none;">
                <div class="file-info">
                    <h3 id="fileName">文件名.pdf</h3>
                    <div class="file-meta">
                        <span id="fileSize">0 MB</span>
                        <span id="filePages">0 页</span>
                        <span id="fileStatus"></span>
                    </div>
                </div>

                <div class="toolbar">
                    <button class="tool-btn btn-primary-action" data-action="convert-to-word" title="一键导出Word(保持格式)">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                            <polyline points="14 2 14 8 20 8" />
                            <line x1="12" y1="18" x2="12" y2="12" />
                            <polyline points="9 15 12 18 15 15" />
                        </svg>
                        📄 导出Word
                    </button>
                    <button class="tool-btn" data-action="extract-text-enhanced" title="提取文字(保留排版表格)">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M3 5h18M3 12h18M3 19h18" />
                        </svg>
                        提取文字(增强)
                    </button>
                    <button class="tool-btn" data-action="extract-tables" title="仅提取表格">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <rect x="3" y="3" width="18" height="18" rx="2" />
                            <line x1="3" y1="9" x2="21" y2="9" />
                            <line x1="9" y1="3" x2="9" y2="21" />
                        </svg>
                        提取表格
                    </button>
                    <button class="tool-btn" data-action="extract-images" title="提取图片">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <rect x="3" y="3" width="18" height="18" rx="2" />
                            <circle cx="8.5" cy="8.5" r="1.5" />
                            <path d="m21 15-5-5L5 21" />
                        </svg>
                        提取图片
                    </button>
                    <button class="tool-btn" data-action="rotate" title="旋转页面">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path
                                d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2" />
                        </svg>
                        旋转
                    </button>
                    <button class="tool-btn" data-action="encrypt" title="加密PDF">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <rect x="3" y="11" width="18" height="11" rx="2" />
                            <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                        </svg>
                        加密
                    </button>
                    <button class="tool-btn" data-action="decrypt" title="解密PDF">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <rect x="3" y="11" width="18" height="11" rx="2" />
                            <path d="M7 11V7a5 5 0 0 1 9.9-1" />
                        </svg>
                        解密
                    </button>
                    <button class="tool-btn btn-danger" data-action="reset" title="重新上传">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path
                                d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />
                        </svg>
                        重新上传
                    </button>
                </div>
            </div>

            <!-- PDF预览区 -->
            <div class="preview-section" id="previewSection" style="display: none;">
                <div class="preview-controls">
                    <button id="prevPage" class="icon-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="m15 18-6-6 6-6" />
                        </svg>
                    </button>
                    <span class="page-indicator">
                        <input type="number" id="currentPage" value="1" min="1"> / <span id="totalPages">1</span>
                    </span>
                    <button id="nextPage" class="icon-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="m9 18 6-6-6-6" />
                        </svg>
                    </button>
                </div>
                <div class="preview-canvas">
                    <img id="previewImage" src="" alt="PDF预览">
                </div>
            </div>

            <!-- 结果显示区 -->
            <div class="result-section" id="resultSection" style="display: none;">
                <h3>处理结果</h3>
                <div id="resultContent"></div>
            </div>
        </main>
    </div>

    <!-- 进度模态框 -->
    <div id="progressModal" class="progress-modal" style="display: none;">
        <div class="progress-content">
            <div class="spinner"></div>
            <p id="progressText">处理中...</p>
            <!-- 新增进度条 -->
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>
    </div>

    <!-- 设置模态框 -->
    <div id="settingsModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>设置</h3>
                <button class="close-btn" onclick="closeSettings()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="enableLayout">
                        保留原始排版 (仅增强提取)
                    </label>
                </div>
                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="enableOCR">
                        启用OCR文字识别 (针对扫描件)
                    </label>
                </div>
                <div class="form-group">
                    <label>默认导出路径 (Word):</label>
                    <input type="text" id="exportPath" class="form-control" placeholder="例如: D:\MyDocuments\Exports">
                    <small style="color: #888;">留空则默认下载到浏览器</small>
                </div>
                <div class="modal-footer">
                    <button class="btn" onclick="closeSettings()">取消</button>
                    <button class="btn btn-primary" onclick="saveSettings()">保存设置</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 导出向导模态框 -->
    <div id="exportModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>导出 Word</h3>
                <button class="close-btn" onclick="closeExportModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>请确认导出路径 (文件夹):</label>
                    <input type="text" id="confirmExportPath" class="form-control"
                        placeholder="例如: D:\MyDocuments\Exports">
                    <small style="color: #666; display: block; margin-top: 5px;">
                        💡 文件将保存到此文件夹，如果留空则下载到浏览器
                    </small>
                </div>
                <div class="modal-footer">
                    <button class="btn" onclick="closeExportModal()">取消</button>
                    <button class="btn btn-primary" onclick="confirmExport()">开始导出</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 图片导出模态框 -->
    <div id="imageExportModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>提取图片</h3>
                <button class="close-btn" onclick="closeImageExportModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>请确认导出路径 (文件夹):</label>
                    <input type="text" id="imageExportPath" class="form-control"
                        placeholder="例如: D:\MyDocuments\Images">
                    <small style="color: #666; display: block; margin-top: 5px;">
                        💡 图片将保存到此文件夹，如果留空则仅在下方显示
                    </small>
                </div>
                <div class="modal-footer">
                    <button class="btn" onclick="closeImageExportModal()">取消</button>
                    <button class="btn btn-primary" onclick="confirmImageExport()">开始提取</button>
                </div>
            </div>
        </div>
    </div>

    <div id="toast" class="toast"></div>

    <script src="js/api.js?v=20251124"></script>
    <script src="js/app.js?v=20251124"></script>
</body>

</html>